3. Tech Stack Alignment
This architecture will adhere to the project's established technology stack while introducing new libraries specifically to enable local-first functionality.

Existing Technology Stack Usage
The enhancement will fully utilize the existing, mandated technologies to ensure consistency.

Category

Current Technology

Usage in Enhancement

Notes

Language

TypeScript

All new code (models, services, hooks) will be written in TypeScript.

Adherence to existing functional and immutable patterns is required.

Framework

React Native + Expo

The entire feature will be built within the existing Expo framework.

No changes to the underlying native project setup are anticipated.

UI Library

React Native Elements

Will be used to create any new UI components for sync/network status feedback.

Ensures visual consistency with the rest of the application.

State/Data

TanStack Query

Will be repurposed to manage the state of the sync service (e.g., isSyncing, error) and to trigger sync operations.

Will no longer be used for direct server data fetching in most views.

Error Handling

Neverthrow

The syncService will use Result and ResultAsync extensively for robust handling of network and data errors.

Continues the project's established pattern for predictable error management.


E-Tablolar'a aktar
New Technology Additions
The following libraries are required to implement the local-first architecture.

Technology

Purpose

Rationale

Integration Method

@nozbe/watermelondb

Core Local Database

Provides the high-performance, observable database that will act as the application's primary data source.

A new DatabaseProvider context will make the DB instance available to the app.

@nozbe/watermelondb
/adapters/sqlite

Native Storage Adapter

Enables WatermelonDB to use the device's native SQLite engine for persistent, performant storage.

Configured during the initialization of the WatermelonDB instance.

@react-native-community
/netinfo

Network Status Detection

To monitor the device's online/offline status, which is a critical trigger for the synchronization service.

A new hook (useNetworkStatus) will provide this information throughout the app.

@react-native-async-storage
/async-storage

Metadata Storage

To persist small pieces of data required by the sync service, such as the timestamp of the last successful sync.

The syncService will read/write to AsyncStorage to manage its state across app sessions.


E-Tablolar'a aktar
