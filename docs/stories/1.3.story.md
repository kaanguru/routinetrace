# Story 1.3: Create and Display Tasks

## Status: Draft

## Story

-   **As a** user,
-   **I want** to create a new task and see a list of my current tasks,
-   **so that** I can begin managing my routines.

## Acceptance Criteria (ACs)

1.  A user can input a title for a new task in a designated input field.
2.  Tapping a "Create Task" button adds the new task to the user's list.
3.  The newly created task is persisted locally via Legend-State.
4.  All existing tasks are displayed in a simple vertical list.
5.  Each item in the list displays the task's title.
6.  The UI for task creation and display is built using React Native Elements (`@rneui/themed`).
7.  The entire feature works seamlessly when the device is offline.

## Tasks / Subtasks

-   [ ] **Task 1: Create Task Input Component** (AC: 1, 6)
    -   [ ] Create a new component `src/components/CreateTaskForm.tsx`.
    -   [ ] The component will contain a text input for the task title and a "Create" button, both styled with `@rneui/themed`.
-   [ ] **Task 2: Create Task List Component** (AC: 4, 5, 6)
    -   [ ] Create a new component `src/components/TaskList.tsx`.
    -   [ ] This component will be responsible for rendering a list of tasks.
    -   [ ] Use a `FlatList` for performance. Each item should display the task title using an `@rneui/themed` `ListItem`.
-   [ ] **Task 3: Implement Task Logic Hook** (AC: 2, 3)
    -   [ ] Create a new custom hook `useTasks.ts` in `src/hooks`.
    -   [ ] This hook will expose a function `addTask(title: string)`.
    -   [ ] The `addTask` function will create a new task object and add it to the `tasks$` observable.
    -   [ ] The hook should also expose the list of all tasks from the `tasks$` observable for the `TaskList` component.
-   [ ] **Task 4: Assemble the Main Screen** (AC: All)
    -   [ ] Create a main screen, e.g., `src/screens/DashboardScreen.tsx`.
    -   [ ] This screen will use the `useTasks` hook.
    -   [ ] It will render the `CreateTaskForm` and the `TaskList` components.
    -   [ ] It will pass the `addTask` function to the `CreateTaskForm`.
    -   [ ] It will pass the tasks data to the `TaskList`.
-   [ ] **Task 5: Unit and E2E Testing** (AC: All)
    -   [ ] Write **Jest** unit tests for the `useTasks` hook, verifying that the `addTask` function correctly modifies the observable.
    -   [ ] Update the **Maestro** E2E test to include a flow for creating a new task and verifying it appears in the list.

## Dev Notes

### Technical Guidance
* **Architecture Reference**: The custom hook pattern is critical here. All state manipulation must happen inside `useTasks.ts`. The UI components should be "dumb" and only call functions from the hook.
* **State Management**: The `useTasks` hook should import the global `tasks$` observable from `src/data/observables.ts`. All new tasks are to be added to this observable. Legend-State will automatically handle persistence and eventual synchronization.
* **Data Model**: When creating a new task, ensure it has a unique ID (you can use a simple UUID generator for this on the client-side), a title, and a default `is_completed` status of `false`.

### Testing
* **Unit Tests**: For the `useTasks` hook, mock the `tasks$` observable. After calling `addTask`, assert that the mocked observable was updated with the new task data.
* **E2E Tests**: The Maestro flow should navigate to the main screen, type a task title into the input field, tap the create button, and then verify that a list item with the new task title is visible on the screen.
